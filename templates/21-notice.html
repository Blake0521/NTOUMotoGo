<!DOCTYPE html>
<html lang="en">

<head>
  <title>海大共乘go</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
  <link rel="stylesheet" href="static/assets/css/main.css" />
  <link rel="icon" href="static/images/helmet.ico" type="image/x-icon">
</head>

<style>
  @import url(https://fonts.googleapis.com/earlyaccess/notosanstc.css);

  body {
    font-family: "Noto Sans TC", "Raleway", sans-serif
  }

  .w3-quarter img {
    margin-bottom: -6px;
    cursor: pointer
  }

  .w3-quarter img:hover {
    opacity: 0.6;
    transition: 0.3s
  }

  .timestyle {
    float: right;
    position: relative;
    top: 10px;
    right: 5px;
    font-size: 10px;
  }
</style>

<body id="top">

  <section id="banner" data-video="static/images/banner">
    <div class="inner">
      <header>
        <h1>Notice</h1>
        <p>您共乘配對成功，或者其他訊息，都會顯示在這兒喔</p>
      </header>
      <a href="#main" class="more">Learn More</a>
    </div>
  </section>

  <header class="w3-container w3-top w3-xlarge w3-padding-16">
    <a href="javascript:void(0)" id="menu" class="w3-right w3-button w3-border" onclick="w3_open()">&#9776;</a>
  </header>

  <!-- Sidebar/menu -->
  <nav class="w3-sidebar w3-bar-block w3-black w3-animate-right w3-top w3-text-light-grey w3-large"
    style="z-index:3;width:250px;font-weight:bold;display:none;right:0;" id="mySidebar">
    <a href="javascript:void()" onclick="w3_close()" class="w3-bar-item w3-button w3-center w3-padding-32">CLOSE</a>
    <a href="/notice" id="notice" onclick="w3_close()" class="w3-bar-item w3-button w3-center w3-padding-16">通知</a>
    <a href="/userInfo" onclick="w3_close()" class="w3-bar-item w3-button w3-center w3-padding-16">個人資訊</a>
    <a href="/home" onclick="w3_close()" class="w3-bar-item w3-button w3-center w3-padding-16">主頁面</a>
    <a href="/history" onclick="w3_close()" class="w3-bar-item w3-button w3-center w3-padding-16">瀏覽歷史資訊</a>
    <a href="/setting" onclick="w3_close()" class="w3-bar-item w3-button w3-center w3-padding-16">設置</a>
  </nav>

  <div class="w3-overlay w3-animate-opacity" onclick="w3_close()" style="cursor:pointer" title="close side menu"
    id="myOverlay"></div>

  <!-- Main -->
  <div id="main">
    <div class="inner">

      <!-- Boxes -->
      <div id="display" class="thumbnails">

      </div>

    </div>
  </div>

  <!-- Scripts -->
  <script src="static/assets/js/jquery.min.js"></script>
  <script src="static/assets/js/jquery.scrolly.min.js"></script>
  <script src="static/assets/js/skel.min.js"></script>
  <script src="static/assets/js/util.js"></script>
  <script src="static/assets/js/main.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.5/socket.io.min.js"></script>
  <script src="static/assets/js/notifation.js"></script>
  <script>
    // Script to open and close sidebar
    function w3_open() {
      document.getElementById("mySidebar").style.display = "block";
      document.getElementById("myOverlay").style.display = "block";
    }

    function w3_close() {
      document.getElementById("mySidebar").style.display = "none";
      document.getElementById("myOverlay").style.display = "none";
    }

    // Modal Image Gallery
    function onClick(element) {
      document.getElementById("img01").src = element.src;
      document.getElementById("modal01").style.display = "block";
      var captionText = document.getElementById("caption");
      captionText.innerHTML = element.alt;
    }


    var displaystr = "";
    

    //創造一個通知欄位
    function creatnotice(data) {
      var displayobj = document.getElementById("display");
      var msgtime = data["msgTime"];

      
      if (data["_type"] == "requ") {
        displaystr = '<div class="box"><div class="inner"><a href="https://tronclass.ntou.edu.tw/" class="button fit">' + data["_msg"] + '<span class="timestyle">'+ data["_msgTime"] +' </a></div></div>' + displaystr;
        displayobj.innerHTML = displaystr;
      }
      if (data["_type"] == "post") {
        displaystr = '<div class="box"><div class="inner"><a href="https://tronclass.ntou.edu.tw/" class="button style2 fit">' + data["_msg"] + '<span class="timestyle">'+ data["_msgTime"] +' </a></div></div>' + displaystr;
        displayobj.innerHTML = displaystr;
      }
      if (data["_type"] == "rate") {
        displaystr = '<div class="box"><div class="inner"><a href="https://tronclass.ntou.edu.tw/" class="button style3 fit">' + data["_msg"] + '<span class="timestyle">'+ data["_msgTime"] +' </a></div></div>' + displaystr;
        displayobj.innerHTML = displaystr;
      }
      if (data["_type"] == "system") {
        displaystr = '<div class="box"><div class="inner"><a class="button style4 fit">' + data["_msg"] + '<span class="timestyle">'+ data["_msgTime"] +' </a></div></div>' + displaystr;
        displayobj.innerHTML = displaystr;
      }

    }

    //有通知時提醒用戶
    function alertnotice() {
      var x = document.getElementById("notice");
      var y = document.getElementById("menu");
      x.innerHTML = "新通知";

      function alert() {
        x.setAttribute("class", "w3-bar-item w3-button w3-center w3-padding-16 w3-animate-zoom");
        setTimeout(function () { x.setAttribute("class", "w3-bar-item w3-button w3-center w3-padding-16") }, 1000);

        y.setAttribute("class", "w3-right w3-button w3-border w3-animate-zoom");
        setTimeout(function () { y.setAttribute("class", "w3-right w3-button w3-border") }, 1000);
      }

      setInterval(alert,1500);
    }


    $(document).ready(function () {
      $.ajax({
        type: 'POST',
        url: "/getNotifation",
        data: JSON.stringify(),
        contentType: 'application/json; charset=utf-8',
        success: function (data) {
          console.log(data);
          for (let i = 0; data[i]; i++) {
            creatnotice(data[i]);
          }
        },
      });
    });


  </script>


</body>

</html>